<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>r-world test</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    canvas {
      background: white;
      border: 1px solid #000;
      touch-action: none;
      image-rendering: pixelated;
    }
  </style>
</head>
<body>

<h1>r-world test</h1>
<p>Tippe auf das Feld ðŸŽ¨</p>

<canvas id="board" width="500" height="500"></canvas>

<script type="module">
  // ðŸ”¥ Firebase Browser SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getFirestore,
    doc,
    setDoc,
    onSnapshot,
    collection
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ðŸ”§ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyCXNvSbBsRVgyKJUmckxpm_WHhC6xflSTg",
    authDomain: "r-world-3879d.firebaseapp.com",
    projectId: "r-world-3879d",
    storageBucket: "r-world-3879d.appspot.com",
    messagingSenderId: "878075356607",
    appId: "1:878075356607:web:c2177f3904858d50626d0a"
  };

  // ðŸš€ Init
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const canvas = document.getElementById("board");
  const ctx = canvas.getContext("2d");

  const PIXEL_SIZE = 10;

  // ðŸŽ¨ Klick / Touch â†’ Pixel setzen
  function handleDraw(e) {
    const rect = canvas.getBoundingClientRect();
    const x = Math.floor((e.clientX - rect.left) / PIXEL_SIZE);
    const y = Math.floor((e.clientY - rect.top) / PIXEL_SIZE);

    const id = `${x}_${y}`;

    setDoc(doc(db, "pixels", id), {
      x,
      y,
      color: "#000000"
    });
  }

  canvas.addEventListener("click", handleDraw);

  // ðŸ“¡ Live-Updates (wie wplace)
  onSnapshot(collection(db, "pixels"), snapshot => {
    snapshot.docChanges().forEach(change => {
      const { x, y, color } = change.doc.data();
      ctx.fillStyle = color;
      ctx.fillRect(
        x * PIXEL_SIZE,
        y * PIXEL_SIZE,
        PIXEL_SIZE,
        PIXEL_SIZE
      );
    });
  });

  console.log("r-world lÃ¤uft âœ…");
</script>

</body>
</html>
